{
   "Version":"2019-10-30",
   "StartAction":"f975c9af-7dff-4e34-9eda-53ad09aecb2a",
   "Metadata":{
      "entryPointPosition":{
         "x":15,
         "y":15
      },
      "snapToGrid":false,
      "ActionMetadata":{
         "f975c9af-7dff-4e34-9eda-53ad09aecb2a":{
            "position":{
               "x":158,
               "y":97
            }
         },
         "5c7d63e5-db92-451e-9da1-028763ee8801":{
            "position":{
               "x":157,
               "y":295
            },
            "overrideConsoleVoice":false,
            "defaultVoice":"Standard"
         },
         "17403bfb-420b-4fa5-bb53-8a7fdf9da0e8":{
            "position":{
               "x":144,
               "y":474
            },
            "useDynamic":false,
            "useDynamicForEncryptionKeys":true,
            "useDynamicForTerminatorDigits":false,
            "countryCodePrefix":"+1"
         },
         "319c4da8-2d6d-4e4b-a18e-9277b13cd7f9":{
            "position":{
               "x":842,
               "y":88
            },
            "useDynamic":false
         },
         "7a1ac8ba-e5f7-423b-bb89-4af7c7372b34":{
            "position":{
               "x":405,
               "y":447
            },
            "useDynamic":false
         },
         "bb212c4b-3f98-4080-b533-fe9d2ca36b70":{
            "position":{
               "x":1171,
               "y":92
            },
            "useDynamic":false,
            "queue":{
               "id":"{{ SAMPLE_QUEUE_ARN }}",
               "text":"Sample BasicQueue"
            }
         },
         "5c69b8bf-4682-4652-8574-4eec6107a865":{
            "position":{
               "x":1539,
               "y":578
            }
         },
         "e501e887-2f34-44dd-8aad-030ca0d96792":{
            "position":{
               "x":1698,
               "y":308
            },
            "useDynamic":false
         },
         "0bf507b6-7f4b-4bf8-95c6-531afca0b152":{
            "position":{
               "x":1427,
               "y":123
            },
            "useDynamic":false
         },
         "93a19012-34f4-47c6-8011-d146cded6f8a":{
            "position":{
               "x":1451,
               "y":323
            }
         },
         "2367a288-95db-4535-ad4f-7d70be3636a9":{
            "position":{
               "x":646,
               "y":416
            },
            "dynamicMetadata":{
               "personnummer":true,
               "orderRef":true
            },
            "useDynamic":false
         },
         "f225dcc9-d666-4ee4-9200-36ef87dd338f":{
            "position":{
               "x":1278,
               "y":544
            },
            "useDynamic":false
         },
         "6162763b-e43c-455b-8330-196642f37027":{
            "position":{
               "x":587,
               "y":140
            },
            "conditionMetadata":[
               {
                  "operator":{
                     "name":"Equals",
                     "value":"Equals",
                     "shortDisplay":"="
                  },
                  "value":"complete",
                  "id":"93bb0ae9-ced8-4d70-88bb-b14770db9098"
               },
               {
                  "operator":{
                     "name":"Equals",
                     "value":"Equals",
                     "shortDisplay":"="
                  },
                  "value":"pending",
                  "id":"fbb30c21-d1b2-4e33-9f4d-b67caab24cc6"
               }
            ]
         },
         "595aea4e-1fa8-4a4c-a0c7-f1711d0caccf":{
            "position":{
               "x":929,
               "y":373
            },
            "useDynamic":false
         }
      }
   },
   "Actions":[
      {
         "Identifier":"f975c9af-7dff-4e34-9eda-53ad09aecb2a",
         "Parameters":{
            "FlowLoggingBehavior":"Enabled"
         },
         "Transitions":{
            "NextAction":"5c7d63e5-db92-451e-9da1-028763ee8801",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"UpdateFlowLoggingBehavior"
      },
      {
         "Identifier":"5c7d63e5-db92-451e-9da1-028763ee8801",
         "Parameters":{
            "TextToSpeechVoice":"Amy"
         },
         "Transitions":{
            "NextAction":"17403bfb-420b-4fa5-bb53-8a7fdf9da0e8",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"UpdateContactTextToSpeechVoice"
      },
      {
         "Identifier":"17403bfb-420b-4fa5-bb53-8a7fdf9da0e8",
         "Parameters":{
            "SSML":"<speak><p>\n<prosody rate=\"91%\"> Thank you for calling. </prosody>\n<prosody rate=\"93%\"> Can you please key in your personal number so we can verify your identity.</prosody>\n</p></speak>",
            "StoreInput":"True",
            "InputTimeLimitSeconds":"10",
            "InputValidation":{
               "CustomValidation":{
                  "MaximumLength":"12"
               }
            },
            "DTMFConfiguration":{
               "DisableCancelKey":"False"
            }
         },
         "Transitions":{
            "NextAction":"7a1ac8ba-e5f7-423b-bb89-4af7c7372b34",
            "Errors":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"NoMatchingError"
               }
            ],
            "Conditions":[
               
            ]
         },
         "Type":"GetParticipantInput"
      },
      {
         "Identifier":"319c4da8-2d6d-4e4b-a18e-9277b13cd7f9",
         "Parameters":{
            "Text":"Hello, $.External.givenName. Please hold while we connect you to an agent."
         },
         "Transitions":{
            "NextAction":"bb212c4b-3f98-4080-b533-fe9d2ca36b70",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"MessageParticipant"
      },
      {
         "Identifier":"7a1ac8ba-e5f7-423b-bb89-4af7c7372b34",
         "Parameters":{
            "SSML":"<speak><p>\n<prosody rate=\"91%\"> Please open your BankID app to verify your identity. <break time=\"2s\"/></prosody>\n</p></speak>"
         },
         "Transitions":{
            "NextAction":"2367a288-95db-4535-ad4f-7d70be3636a9",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"MessageParticipant"
      },
      {
         "Identifier":"bb212c4b-3f98-4080-b533-fe9d2ca36b70",
         "Parameters":{
            "QueueId":"{{ SAMPLE_QUEUE_ARN }}"
         },
         "Transitions":{
            "NextAction":"0bf507b6-7f4b-4bf8-95c6-531afca0b152",
            "Errors":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"NoMatchingError"
               }
            ],
            "Conditions":[
               
            ]
         },
         "Type":"UpdateContactTargetQueue"
      },
      {
         "Identifier":"5c69b8bf-4682-4652-8574-4eec6107a865",
         "Type":"DisconnectParticipant",
         "Parameters":{
            
         },
         "Transitions":{
            
         }
      },
      {
         "Identifier":"e501e887-2f34-44dd-8aad-030ca0d96792",
         "Transitions":{
            "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
            "Errors":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"NoMatchingError"
               },
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"QueueAtCapacity"
               }
            ],
            "Conditions":[
               
            ]
         },
         "Type":"TransferContactToQueue"
      },
      {
         "Identifier":"0bf507b6-7f4b-4bf8-95c6-531afca0b152",
         "Parameters":{
            "Text":"This call is recorded for training purposes."
         },
         "Transitions":{
            "NextAction":"93a19012-34f4-47c6-8011-d146cded6f8a",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"MessageParticipant"
      },
      {
         "Identifier":"93a19012-34f4-47c6-8011-d146cded6f8a",
         "Parameters":{
            "RecordingBehavior":{
               "RecordedParticipants":[
                  "Agent",
                  "Customer"
               ]
            }
         },
         "Transitions":{
            "NextAction":"e501e887-2f34-44dd-8aad-030ca0d96792",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"UpdateContactRecordingBehavior"
      },
      {
         "Identifier":"2367a288-95db-4535-ad4f-7d70be3636a9",
         "Parameters":{
            "LambdaFunctionARN":"{{ LAMBDA_FUNCTION_ARN }}",
            "InvocationTimeLimitSeconds":"8",
            "LambdaInvocationAttributes":{
               "orderRef":"$.External.orderRef",
               "personnummer":"$.StoredCustomerInput"
            }
         },
         "Transitions":{
            "NextAction":"6162763b-e43c-455b-8330-196642f37027",
            "Errors":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"NoMatchingError"
               }
            ],
            "Conditions":[
               
            ]
         },
         "Type":"InvokeLambdaFunction"
      },
      {
         "Identifier":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
         "Parameters":{
            "Text":"Sorry. We cannot take your call right now. Please call back later. Goodbye."
         },
         "Transitions":{
            "NextAction":"5c69b8bf-4682-4652-8574-4eec6107a865",
            "Errors":[
               
            ],
            "Conditions":[
               
            ]
         },
         "Type":"MessageParticipant"
      },
      {
         "Identifier":"6162763b-e43c-455b-8330-196642f37027",
         "Parameters":{
            "ComparisonValue":"$.External.status"
         },
         "Transitions":{
            "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
            "Errors":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "ErrorType":"NoMatchingCondition"
               }
            ],
            "Conditions":[
               {
                  "NextAction":"319c4da8-2d6d-4e4b-a18e-9277b13cd7f9",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "complete"
                     ]
                  }
               },
               {
                  "NextAction":"595aea4e-1fa8-4a4c-a0c7-f1711d0caccf",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "pending"
                     ]
                  }
               }
            ]
         },
         "Type":"Compare"
      },
      {
         "Identifier":"595aea4e-1fa8-4a4c-a0c7-f1711d0caccf",
         "Parameters":{
            "LoopCount":"2"
         },
         "Transitions":{
            "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
            "Errors":[
               
            ],
            "Conditions":[
               {
                  "NextAction":"f225dcc9-d666-4ee4-9200-36ef87dd338f",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "DoneLooping"
                     ]
                  }
               },
               {
                  "NextAction":"2367a288-95db-4535-ad4f-7d70be3636a9",
                  "Condition":{
                     "Operator":"Equals",
                     "Operands":[
                        "ContinueLooping"
                     ]
                  }
               }
            ]
         },
         "Type":"Loop"
      }
   ]
}
